"""
Generate beautiful prospectus for Hera in English and Korean
Matches the actual website design with purple gradient theme
"""
from reportlab.lib.pagesizes import A4
from reportlab.lib import colors
from reportlab.lib.units import cm, mm
from reportlab.pdfgen import canvas
from reportlab.lib.utils import ImageReader
from reportlab.platypus import Paragraph
from reportlab.lib.styles import ParagraphStyle
import os

# Hera brand colors (from the actual website)
COLORS = {
    'purple_dark': colors.HexColor('#6b21a8'),
    'purple_main': colors.HexColor('#9333ea'),
    'purple_light': colors.HexColor('#a855f7'),
    'purple_bg': colors.HexColor('#f3e8ff'),
    'white': colors.white,
    'text_dark': colors.HexColor('#1f2937'),
    'text_gray': colors.HexColor('#6b7280'),
}

def draw_gradient_rect(c, x, y, width, height, color1, color2):
    """Draw a gradient rectangle"""
    steps = 50
    for i in range(steps):
        ratio = i / steps
        r = color1.red * (1 - ratio) + color2.red * ratio
        g = color1.green * (1 - ratio) + color2.green * ratio
        b = color1.blue * (1 - ratio) + color2.blue * ratio
        c.setFillColor(colors.Color(r, g, b))
        step_height = height / steps
        c.rect(x, y + i * step_height, width, step_height, fill=True, stroke=False)

def create_prospectus_english():
    """Create English version of the prospectus"""
    filename = "Hera_Prospectus_English.pdf"
    c = canvas.Canvas(filename, pagesize=A4)
    width, height = A4
    
    # ===== BEAUTIFUL GRADIENT HEADER =====
    draw_gradient_rect(c, 0, height - 10*cm, width, 10*cm, COLORS['purple_main'], COLORS['purple_dark'])
    
    # Decorative circles (like the website)
    c.setFillColor(colors.Color(1, 1, 1, alpha=0.1))
    c.circle(width * 0.2, height - 4*cm, 3*cm, fill=True, stroke=False)
    c.circle(width * 0.8, height - 7*cm, 4*cm, fill=True, stroke=False)
    
    # Logo/Title
    c.setFillColor(COLORS['white'])
    c.setFont("Helvetica-Bold", 52)
    c.drawCentredString(width/2, height - 4*cm, "Hera")
    
    # Emoji decoration
    c.setFont("Helvetica", 30)
    c.drawCentredString(width/2, height - 5.2*cm, "âœ¨ ğŸ¨ âœ¨")
    
    # Subtitle
    c.setFont("Helvetica", 22)
    c.drawCentredString(width/2, height - 6.5*cm, "AI-Powered Personalized Coloring Books")
    
    c.setFont("Helvetica-Bold", 16)
    c.drawCentredString(width/2, height - 7.5*cm, "For Kids Who Love to Create")
    
    # ===== MAIN CONTENT WITH MODERN CARDS =====
    y_pos = height - 12*cm
    
    # What is Hera? - Card 1
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3.5*cm, width - 4*cm, 3.5*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos - 1*cm, "ğŸŒŸ What is Hera?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    text_lines = [
        "Transform your child's imagination into beautiful personalized coloring books!",
        "Every page is unique, generated by artificial intelligence, and perfectly adapted",
        "to your child's preferences. Create magical stories in minutes."
    ]
    for i, line in enumerate(text_lines):
        c.drawString(2.5*cm, y_pos - 1.8*cm - i*0.6*cm, line)
    
    y_pos -= 4.5*cm
    
    # How it works - Step by step with icons
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos, "âš¡ How It Works")
    
    y_pos -= 1*cm
    
    steps = [
        ("1ï¸âƒ£", "Choose a Theme", "Animals, Nature, Fantasy, Science, Transport, Daily Life..."),
        ("2ï¸âƒ£", "Select a Style", "Ghibli, Cartoon, Minimal, Comic, Detailed, Magical..."),
        ("3ï¸âƒ£", "Customize", "Number of pages (5-30), difficulty level, color palette"),
        ("4ï¸âƒ£", "Get Your Book!", "Download your unique PDF or order a printed version")
    ]
    
    for emoji, title, desc in steps:
        # Colored circle for step number
        c.setFillColor(COLORS['purple_main'])
        c.circle(2.8*cm, y_pos + 0.1*cm, 0.4*cm, fill=True, stroke=False)
        
        c.setFillColor(COLORS['white'])
        c.setFont("Helvetica-Bold", 12)
        c.drawCentredString(2.8*cm, y_pos - 0.1*cm, emoji)
        
        c.setFillColor(COLORS['purple_dark'])
        c.setFont("Helvetica-Bold", 12)
        c.drawString(3.8*cm, y_pos + 0.1*cm, title)
        
        c.setFillColor(COLORS['text_dark'])
        c.setFont("Helvetica", 10)
        c.drawString(3.8*cm, y_pos - 0.4*cm, desc)
        
        y_pos -= 1.2*cm
    
    y_pos -= 0.5*cm
    
    # Features highlight box
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3*cm, width - 4*cm, 3*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2.5*cm, y_pos - 0.8*cm, "ğŸ’œ Why Choose Hera?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 10)
    features = [
        "âœ“ Available in 6 languages (English, French, Korean, Chinese, Japanese, Spanish)",
        "âœ“ High-quality AI-generated illustrations",
        "âœ“ Instant PDF download + Optional printed book",
        "âœ“ Suitable for all ages and skill levels",
        "âœ“ Affordable: Starting at $9.99"
    ]
    for i, feat in enumerate(features):
        c.drawString(2.8*cm, y_pos - 1.6*cm - i*0.5*cm, feat)
    
    y_pos -= 4*cm
    
    # ===== TEST INSTRUCTIONS - IMPORTANT BOX =====
    c.setFillColor(colors.HexColor('#fef3c7'))
    c.setStrokeColor(colors.HexColor('#f59e0b'))
    c.setLineWidth(2)
    c.roundRect(1.5*cm, y_pos - 4*cm, width - 3*cm, 4*cm, 10, fill=True, stroke=True)
    
    c.setFillColor(colors.HexColor('#b45309'))
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2*cm, y_pos - 1*cm, "ğŸ§ª TEST IT FOR FREE!")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    c.drawString(2*cm, y_pos - 1.8*cm, "At checkout, use these test credit card details:")
    
    c.setFont("Helvetica-Bold", 12)
    c.setFillColor(colors.HexColor('#b45309'))
    c.drawString(2.5*cm, y_pos - 2.5*cm, "ğŸ’³ Card Number:  4242 4242 4242 4242")
    c.drawString(2.5*cm, y_pos - 3.1*cm, "ğŸ“… Expiry Date:  12/25")
    c.drawString(2.5*cm, y_pos - 3.7*cm, "ğŸ”’ CVV:  123")
    
    c.setFont("Helvetica-Oblique", 9)
    c.setFillColor(COLORS['text_gray'])
    c.drawString(2*cm, y_pos - 4.3*cm, "Then enter your real email address and any name to receive your test PDF!")
    
    # ===== FOOTER WITH QR CODES =====
    footer_y = 5*cm
    
    # Decorative line
    c.setStrokeColor(COLORS['purple_main'])
    c.setLineWidth(2)
    c.line(2*cm, footer_y, width - 2*cm, footer_y)
    
    # QR Codes section title
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 14)
    c.drawCentredString(width/2, footer_y - 1*cm, "ğŸ“± Scan to Connect")
    
    # Website QR Code (Left)
    try:
        qr_website = ImageReader('images/link_website.jpg')
        c.drawImage(qr_website, 4*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(4*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(5.5*cm, footer_y - 5.2*cm, "ğŸŒ Website")
    
    # Instagram QR Code (Right)
    try:
        qr_insta = ImageReader('images/insta_link.jpeg')
        c.drawImage(qr_insta, width - 7*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(width - 7*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(width - 5.5*cm, footer_y - 5.2*cm, "ğŸ“¸ Instagram")
    
    # Contact info
    c.setFillColor(COLORS['text_gray'])
    c.setFont("Helvetica", 9)
    c.drawCentredString(width/2, 1.2*cm, "ğŸ“§ hera.work.noreply@gmail.com")
    c.setFont("Helvetica-Bold", 9)
    c.setFillColor(COLORS['purple_main'])
    c.drawCentredString(width/2, 0.6*cm, "Made with ğŸ’œ by Hera Team")
    
    c.save()
    print(f"âœ… English prospectus created: {filename}")

def create_prospectus_korean():
    """Create Korean version of the prospectus"""
    filename = "Hera_Prospectus_Korean.pdf"
    c = canvas.Canvas(filename, pagesize=A4)
    width, height = A4
    
    # ===== BEAUTIFUL GRADIENT HEADER =====
    draw_gradient_rect(c, 0, height - 10*cm, width, 10*cm, COLORS['purple_main'], COLORS['purple_dark'])
    
    # Decorative circles
    c.setFillColor(colors.Color(1, 1, 1, alpha=0.1))
    c.circle(width * 0.2, height - 4*cm, 3*cm, fill=True, stroke=False)
    c.circle(width * 0.8, height - 7*cm, 4*cm, fill=True, stroke=False)
    
    # Logo/Title
    c.setFillColor(COLORS['white'])
    c.setFont("Helvetica-Bold", 52)
    c.drawCentredString(width/2, height - 4*cm, "Hera")
    
    # Emoji decoration
    c.setFont("Helvetica", 30)
    c.drawCentredString(width/2, height - 5.2*cm, "âœ¨ ğŸ¨ âœ¨")
    
    # Subtitle (Korean)
    c.setFont("Helvetica", 22)
    c.drawCentredString(width/2, height - 6.5*cm, "AI ê¸°ë°˜ ë§ì¶¤í˜• ì»¬ëŸ¬ë§ë¶")
    
    c.setFont("Helvetica-Bold", 16)
    c.drawCentredString(width/2, height - 7.5*cm, "ì°½ì˜ë ¥ì„ ì‚¬ë‘í•˜ëŠ” ì•„ì´ë“¤ì„ ìœ„í•œ")
    
    # ===== MAIN CONTENT =====
    y_pos = height - 12*cm
    
    # What is Hera?
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3.5*cm, width - 4*cm, 3.5*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos - 1*cm, "ğŸŒŸ Heraë€ ë¬´ì—‡ì¸ê°€ìš”?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    text_lines = [
        "ì•„ì´ì˜ ìƒìƒë ¥ì„ ì•„ë¦„ë‹¤ìš´ ë§ì¶¤í˜• ì»¬ëŸ¬ë§ë¶ìœ¼ë¡œ ë³€í™˜í•˜ì„¸ìš”!",
        "ëª¨ë“  í˜ì´ì§€ëŠ” ì¸ê³µì§€ëŠ¥ìœ¼ë¡œ ìƒì„±ëœ ê³ ìœ í•œ ë””ìì¸ì´ë©°,",
        "ì•„ì´ì˜ ì·¨í–¥ì— ì™„ë²½í•˜ê²Œ ë§ì¶°ì§‘ë‹ˆë‹¤. ëª‡ ë¶„ ë§Œì— ë§ˆë²• ê°™ì€ ì´ì•¼ê¸°ë¥¼ ë§Œë“œì„¸ìš”."
    ]
    for i, line in enumerate(text_lines):
        c.drawString(2.5*cm, y_pos - 1.8*cm - i*0.6*cm, line)
    
    y_pos -= 4.5*cm
    
    # How it works
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos, "âš¡ ì‘ë™ ë°©ì‹")
    
    y_pos -= 1*cm
    
    steps = [
        ("1ï¸âƒ£", "í…Œë§ˆ ì„ íƒ", "ë™ë¬¼, ìì—°, íŒíƒ€ì§€, ê³¼í•™, êµí†µ, ì¼ìƒìƒí™œ..."),
        ("2ï¸âƒ£", "ìŠ¤íƒ€ì¼ ì„ íƒ", "ì§€ë¸Œë¦¬, ë§Œí™”, ë¯¸ë‹ˆë©€, ì½”ë¯¹, ë””í…Œì¼, ë§ˆë²•..."),
        ("3ï¸âƒ£", "ë§ì¶¤ ì„¤ì •", "í˜ì´ì§€ ìˆ˜ (5-30), ë‚œì´ë„, ìƒ‰ìƒ íŒ”ë ˆíŠ¸"),
        ("4ï¸âƒ£", "ì±… ë°›ê¸°!", "ê³ ìœ í•œ PDF ë‹¤ìš´ë¡œë“œ ë˜ëŠ” ì¸ì‡„ë³¸ ì£¼ë¬¸")
    ]
    
    for emoji, title, desc in steps:
        c.setFillColor(COLORS['purple_main'])
        c.circle(2.8*cm, y_pos + 0.1*cm, 0.4*cm, fill=True, stroke=False)
        
        c.setFillColor(COLORS['white'])
        c.setFont("Helvetica-Bold", 12)
        c.drawCentredString(2.8*cm, y_pos - 0.1*cm, emoji)
        
        c.setFillColor(COLORS['purple_dark'])
        c.setFont("Helvetica-Bold", 12)
        c.drawString(3.8*cm, y_pos + 0.1*cm, title)
        
        c.setFillColor(COLORS['text_dark'])
        c.setFont("Helvetica", 10)
        c.drawString(3.8*cm, y_pos - 0.4*cm, desc)
        
        y_pos -= 1.2*cm
    
    y_pos -= 0.5*cm
    
    # Features
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3*cm, width - 4*cm, 3*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2.5*cm, y_pos - 0.8*cm, "ğŸ’œ ì™œ Heraë¥¼ ì„ íƒí•´ì•¼ í•˜ë‚˜ìš”?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 10)
    features = [
        "âœ“ 6ê°œ ì–¸ì–´ ì§€ì› (ì˜ì–´, í”„ë‘ìŠ¤ì–´, í•œêµ­ì–´, ì¤‘êµ­ì–´, ì¼ë³¸ì–´, ìŠ¤í˜ì¸ì–´)",
        "âœ“ ê³ í’ˆì§ˆ AI ìƒì„± ì¼ëŸ¬ìŠ¤íŠ¸",
        "âœ“ ì¦‰ì‹œ PDF ë‹¤ìš´ë¡œë“œ + ì„ íƒì  ì¸ì‡„ë³¸",
        "âœ“ ëª¨ë“  ì—°ë ¹ê³¼ ë‚œì´ë„ì— ì í•©",
        "âœ“ ì €ë ´í•œ ê°€ê²©: $9.99ë¶€í„°"
    ]
    for i, feat in enumerate(features):
        c.drawString(2.8*cm, y_pos - 1.6*cm - i*0.5*cm, feat)
    
    y_pos -= 4*cm
    
    # ===== TEST INSTRUCTIONS =====
    c.setFillColor(colors.HexColor('#fef3c7'))
    c.setStrokeColor(colors.HexColor('#f59e0b'))
    c.setLineWidth(2)
    c.roundRect(1.5*cm, y_pos - 4*cm, width - 3*cm, 4*cm, 10, fill=True, stroke=True)
    
    c.setFillColor(colors.HexColor('#b45309'))
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2*cm, y_pos - 1*cm, "ğŸ§ª ë¬´ë£Œë¡œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”!")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    c.drawString(2*cm, y_pos - 1.8*cm, "ê²°ì œ ì‹œ ë‹¤ìŒ í…ŒìŠ¤íŠ¸ ì¹´ë“œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:")
    
    c.setFont("Helvetica-Bold", 12)
    c.setFillColor(colors.HexColor('#b45309'))
    c.drawString(2.5*cm, y_pos - 2.5*cm, "ğŸ’³ ì¹´ë“œ ë²ˆí˜¸:  4242 4242 4242 4242")
    c.drawString(2.5*cm, y_pos - 3.1*cm, "ğŸ“… ë§Œë£Œì¼:  12/25")
    c.drawString(2.5*cm, y_pos - 3.7*cm, "ğŸ”’ CVV:  123")
    
    c.setFont("Helvetica-Oblique", 9)
    c.setFillColor(COLORS['text_gray'])
    c.drawString(2*cm, y_pos - 4.3*cm, "ê·¸ëŸ° ë‹¤ìŒ ì‹¤ì œ ì´ë©”ì¼ ì£¼ì†Œì™€ ì´ë¦„ì„ ì…ë ¥í•˜ì—¬ í…ŒìŠ¤íŠ¸ PDFë¥¼ ë°›ìœ¼ì„¸ìš”!")
    
    # ===== FOOTER WITH QR CODES =====
    footer_y = 5*cm
    
    c.setStrokeColor(COLORS['purple_main'])
    c.setLineWidth(2)
    c.line(2*cm, footer_y, width - 2*cm, footer_y)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 14)
    c.drawCentredString(width/2, footer_y - 1*cm, "ğŸ“± ìŠ¤ìº”í•˜ì—¬ ì—°ê²°í•˜ê¸°")
    
    # QR Codes
    try:
        qr_website = ImageReader('images/link_website.jpg')
        c.drawImage(qr_website, 4*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(4*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(5.5*cm, footer_y - 5.2*cm, "ğŸŒ ì›¹ì‚¬ì´íŠ¸")
    
    try:
        qr_insta = ImageReader('images/insta_link.jpeg')
        c.drawImage(qr_insta, width - 7*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(width - 7*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(width - 5.5*cm, footer_y - 5.2*cm, "ğŸ“¸ ì¸ìŠ¤íƒ€ê·¸ë¨")
    
    # Contact
    c.setFillColor(COLORS['text_gray'])
    c.setFont("Helvetica", 9)
    c.drawCentredString(width/2, 1.2*cm, "ğŸ“§ hera.work.noreply@gmail.com")
    c.setFont("Helvetica-Bold", 9)
    c.setFillColor(COLORS['purple_main'])
    c.drawCentredString(width/2, 0.6*cm, "Made with ğŸ’œ by Hera Team")
    
    c.save()
    print(f"âœ… Korean prospectus created: {filename}")

if __name__ == "__main__":
    print("ğŸ¨ Creating beautiful Hera prospectuses...\n")
    create_prospectus_english()
    create_prospectus_korean()
    print("\nâœ¨ All prospectuses created successfully!")
    print(f"ğŸ“ Location: {os.path.abspath('.')}")
