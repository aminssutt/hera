"""
Generate beautiful prospectus for Hera in English and Korean
Matches the actual website design with purple gradient theme
"""
from reportlab.lib.pagesizes import A4
from reportlab.lib import colors
from reportlab.lib.units import cm, mm
from reportlab.pdfgen import canvas
from reportlab.lib.utils import ImageReader
from reportlab.platypus import Paragraph
from reportlab.lib.styles import ParagraphStyle
import os

# Hera brand colors (from the actual website)
COLORS = {
    'purple_dark': colors.HexColor('#6b21a8'),
    'purple_main': colors.HexColor('#9333ea'),
    'purple_light': colors.HexColor('#a855f7'),
    'purple_bg': colors.HexColor('#f3e8ff'),
    'white': colors.white,
    'text_dark': colors.HexColor('#1f2937'),
    'text_gray': colors.HexColor('#6b7280'),
}

def draw_gradient_rect(c, x, y, width, height, color1, color2):
    """Draw a gradient rectangle"""
    steps = 50
    for i in range(steps):
        ratio = i / steps
        r = color1.red * (1 - ratio) + color2.red * ratio
        g = color1.green * (1 - ratio) + color2.green * ratio
        b = color1.blue * (1 - ratio) + color2.blue * ratio
        c.setFillColor(colors.Color(r, g, b))
        step_height = height / steps
        c.rect(x, y + i * step_height, width, step_height, fill=True, stroke=False)

def create_prospectus_english():
    """Create English version of the prospectus"""
    filename = "Hera_Prospectus_English.pdf"
    c = canvas.Canvas(filename, pagesize=A4)
    width, height = A4
    
    # ===== BEAUTIFUL GRADIENT HEADER =====
    draw_gradient_rect(c, 0, height - 10*cm, width, 10*cm, COLORS['purple_main'], COLORS['purple_dark'])
    
    # Decorative circles (like the website)
    c.setFillColor(colors.Color(1, 1, 1, alpha=0.1))
    c.circle(width * 0.2, height - 4*cm, 3*cm, fill=True, stroke=False)
    c.circle(width * 0.8, height - 7*cm, 4*cm, fill=True, stroke=False)
    
    # Logo/Title
    c.setFillColor(COLORS['white'])
    c.setFont("Helvetica-Bold", 52)
    c.drawCentredString(width/2, height - 4*cm, "Hera")
    
    # Emoji decoration
    c.setFont("Helvetica", 30)
    c.drawCentredString(width/2, height - 5.2*cm, "‚ú® üé® ‚ú®")
    
    # Subtitle
    c.setFont("Helvetica", 22)
    c.drawCentredString(width/2, height - 6.5*cm, "AI-Powered Personalized Coloring Books")
    
    c.setFont("Helvetica-Bold", 16)
    c.drawCentredString(width/2, height - 7.5*cm, "For Kids Who Love to Create")
    
    # ===== MAIN CONTENT WITH MODERN CARDS =====
    y_pos = height - 12*cm
    
    # What is Hera? - Card 1
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3.5*cm, width - 4*cm, 3.5*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos - 1*cm, "üåü What is Hera?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    text_lines = [
        "Transform your child's imagination into beautiful personalized coloring books!",
        "Every page is unique, generated by artificial intelligence, and perfectly adapted",
        "to your child's preferences. Create magical stories in minutes."
    ]
    for i, line in enumerate(text_lines):
        c.drawString(2.5*cm, y_pos - 1.8*cm - i*0.6*cm, line)
    
    y_pos -= 4.5*cm
    
    # How it works - Step by step with icons
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos, "‚ö° How It Works")
    
    y_pos -= 1*cm
    
    steps = [
        ("1Ô∏è‚É£", "Choose a Theme", "Animals, Nature, Fantasy, Science, Transport, Daily Life..."),
        ("2Ô∏è‚É£", "Select a Style", "Ghibli, Cartoon, Minimal, Comic, Detailed, Magical..."),
        ("3Ô∏è‚É£", "Customize", "Number of pages (5-30), difficulty level, color palette"),
        ("4Ô∏è‚É£", "Get Your Book!", "Download your unique PDF or order a printed version")
    ]
    
    for emoji, title, desc in steps:
        # Colored circle for step number
        c.setFillColor(COLORS['purple_main'])
        c.circle(2.8*cm, y_pos + 0.1*cm, 0.4*cm, fill=True, stroke=False)
        
        c.setFillColor(COLORS['white'])
        c.setFont("Helvetica-Bold", 12)
        c.drawCentredString(2.8*cm, y_pos - 0.1*cm, emoji)
        
        c.setFillColor(COLORS['purple_dark'])
        c.setFont("Helvetica-Bold", 12)
        c.drawString(3.8*cm, y_pos + 0.1*cm, title)
        
        c.setFillColor(COLORS['text_dark'])
        c.setFont("Helvetica", 10)
        c.drawString(3.8*cm, y_pos - 0.4*cm, desc)
        
        y_pos -= 1.2*cm
    
    y_pos -= 0.5*cm
    
    # Features highlight box
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3*cm, width - 4*cm, 3*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2.5*cm, y_pos - 0.8*cm, "üíú Why Choose Hera?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 10)
    features = [
        "‚úì Available in 6 languages (English, French, Korean, Chinese, Japanese, Spanish)",
        "‚úì High-quality AI-generated illustrations",
        "‚úì Instant PDF download + Optional printed book",
        "‚úì Suitable for all ages and skill levels",
        "‚úì Affordable: Starting at $9.99"
    ]
    for i, feat in enumerate(features):
        c.drawString(2.8*cm, y_pos - 1.6*cm - i*0.5*cm, feat)
    
    y_pos -= 4*cm
    
    # ===== TEST INSTRUCTIONS - IMPORTANT BOX =====
    c.setFillColor(colors.HexColor('#fef3c7'))
    c.setStrokeColor(colors.HexColor('#f59e0b'))
    c.setLineWidth(2)
    c.roundRect(1.5*cm, y_pos - 4*cm, width - 3*cm, 4*cm, 10, fill=True, stroke=True)
    
    c.setFillColor(colors.HexColor('#b45309'))
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2*cm, y_pos - 1*cm, "üß™ TEST IT FOR FREE!")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    c.drawString(2*cm, y_pos - 1.8*cm, "At checkout, use these test credit card details:")
    
    c.setFont("Helvetica-Bold", 12)
    c.setFillColor(colors.HexColor('#b45309'))
    c.drawString(2.5*cm, y_pos - 2.5*cm, "üí≥ Card Number:  4242 4242 4242 4242")
    c.drawString(2.5*cm, y_pos - 3.1*cm, "üìÖ Expiry Date:  12/25")
    c.drawString(2.5*cm, y_pos - 3.7*cm, "üîí CVV:  123")
    
    c.setFont("Helvetica-Oblique", 9)
    c.setFillColor(COLORS['text_gray'])
    c.drawString(2*cm, y_pos - 4.3*cm, "Then enter your real email address and any name to receive your test PDF!")
    
    # ===== FOOTER WITH QR CODES =====
    footer_y = 5*cm
    
    # Decorative line
    c.setStrokeColor(COLORS['purple_main'])
    c.setLineWidth(2)
    c.line(2*cm, footer_y, width - 2*cm, footer_y)
    
    # QR Codes section title
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 14)
    c.drawCentredString(width/2, footer_y - 1*cm, "üì± Scan to Connect")
    
    # Website QR Code (Left)
    try:
        qr_website = ImageReader('images/link_website.jpg')
        c.drawImage(qr_website, 4*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(4*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(5.5*cm, footer_y - 5.2*cm, "üåê Website")
    
    # Instagram QR Code (Right)
    try:
        qr_insta = ImageReader('images/insta_link.jpeg')
        c.drawImage(qr_insta, width - 7*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(width - 7*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(width - 5.5*cm, footer_y - 5.2*cm, "üì∏ Instagram")
    
    # Contact info
    c.setFillColor(COLORS['text_gray'])
    c.setFont("Helvetica", 9)
    c.drawCentredString(width/2, 1.2*cm, "üìß hera.work.noreply@gmail.com")
    c.setFont("Helvetica-Bold", 9)
    c.setFillColor(COLORS['purple_main'])
    c.drawCentredString(width/2, 0.6*cm, "Made with üíú by Hera Team")
    
    c.save()
    print(f"‚úÖ English prospectus created: {filename}")

def create_prospectus_korean():
    """Create Korean version of the prospectus"""
    filename = "Hera_Prospectus_Korean.pdf"
    c = canvas.Canvas(filename, pagesize=A4)
    width, height = A4
    
    # ===== BEAUTIFUL GRADIENT HEADER =====
    draw_gradient_rect(c, 0, height - 10*cm, width, 10*cm, COLORS['purple_main'], COLORS['purple_dark'])
    
    # Decorative circles
    c.setFillColor(colors.Color(1, 1, 1, alpha=0.1))
    c.circle(width * 0.2, height - 4*cm, 3*cm, fill=True, stroke=False)
    c.circle(width * 0.8, height - 7*cm, 4*cm, fill=True, stroke=False)
    
    # Logo/Title
    c.setFillColor(COLORS['white'])
    c.setFont("Helvetica-Bold", 52)
    c.drawCentredString(width/2, height - 4*cm, "Hera")
    
    # Emoji decoration
    c.setFont("Helvetica", 30)
    c.drawCentredString(width/2, height - 5.2*cm, "‚ú® üé® ‚ú®")
    
    # Subtitle (Korean)
    c.setFont("Helvetica", 22)
    c.drawCentredString(width/2, height - 6.5*cm, "AI Í∏∞Î∞ò ÎßûÏ∂§Ìòï Ïª¨Îü¨ÎßÅÎ∂Å")
    
    c.setFont("Helvetica-Bold", 16)
    c.drawCentredString(width/2, height - 7.5*cm, "Ï∞ΩÏùòÎ†•ÏùÑ ÏÇ¨ÎûëÌïòÎäî ÏïÑÏù¥Îì§ÏùÑ ÏúÑÌïú")
    
    # ===== MAIN CONTENT =====
    y_pos = height - 12*cm
    
    # What is Hera?
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3.5*cm, width - 4*cm, 3.5*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos - 1*cm, "üåü HeraÎûÄ Î¨¥ÏóáÏù∏Í∞ÄÏöî?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    text_lines = [
        "ÏïÑÏù¥Ïùò ÏÉÅÏÉÅÎ†•ÏùÑ ÏïÑÎ¶ÑÎã§Ïö¥ ÎßûÏ∂§Ìòï Ïª¨Îü¨ÎßÅÎ∂ÅÏúºÎ°ú Î≥ÄÌôòÌïòÏÑ∏Ïöî!",
        "Î™®Îì† ÌéòÏù¥ÏßÄÎäî Ïù∏Í≥µÏßÄÎä•ÏúºÎ°ú ÏÉùÏÑ±Îêú Í≥†Ïú†Ìïú ÎîîÏûêÏù∏Ïù¥Î©∞,",
        "ÏïÑÏù¥Ïùò Ï∑®Ìñ•Ïóê ÏôÑÎ≤ΩÌïòÍ≤å ÎßûÏ∂∞ÏßëÎãàÎã§. Î™á Î∂Ñ ÎßåÏóê ÎßàÎ≤ï Í∞ôÏùÄ Ïù¥ÏïºÍ∏∞Î•º ÎßåÎìúÏÑ∏Ïöî."
    ]
    for i, line in enumerate(text_lines):
        c.drawString(2.5*cm, y_pos - 1.8*cm - i*0.6*cm, line)
    
    y_pos -= 4.5*cm
    
    # How it works
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 18)
    c.drawString(2.5*cm, y_pos, "‚ö° ÏûëÎèô Î∞©Ïãù")
    
    y_pos -= 1*cm
    
    steps = [
        ("1Ô∏è‚É£", "ÌÖåÎßà ÏÑ†ÌÉù", "ÎèôÎ¨º, ÏûêÏó∞, ÌåêÌÉÄÏßÄ, Í≥ºÌïô, ÍµêÌÜµ, ÏùºÏÉÅÏÉùÌôú..."),
        ("2Ô∏è‚É£", "Ïä§ÌÉÄÏùº ÏÑ†ÌÉù", "ÏßÄÎ∏åÎ¶¨, ÎßåÌôî, ÎØ∏ÎãàÎ©Ä, ÏΩîÎØπ, ÎîîÌÖåÏùº, ÎßàÎ≤ï..."),
        ("3Ô∏è‚É£", "ÎßûÏ∂§ ÏÑ§Ï†ï", "ÌéòÏù¥ÏßÄ Ïàò (5-30), ÎÇúÏù¥ÎèÑ, ÏÉâÏÉÅ ÌåîÎ†àÌä∏"),
        ("4Ô∏è‚É£", "Ï±Ö Î∞õÍ∏∞!", "Í≥†Ïú†Ìïú PDF Îã§Ïö¥Î°úÎìú ÎòêÎäî Ïù∏ÏáÑÎ≥∏ Ï£ºÎ¨∏")
    ]
    
    for emoji, title, desc in steps:
        c.setFillColor(COLORS['purple_main'])
        c.circle(2.8*cm, y_pos + 0.1*cm, 0.4*cm, fill=True, stroke=False)
        
        c.setFillColor(COLORS['white'])
        c.setFont("Helvetica-Bold", 12)
        c.drawCentredString(2.8*cm, y_pos - 0.1*cm, emoji)
        
        c.setFillColor(COLORS['purple_dark'])
        c.setFont("Helvetica-Bold", 12)
        c.drawString(3.8*cm, y_pos + 0.1*cm, title)
        
        c.setFillColor(COLORS['text_dark'])
        c.setFont("Helvetica", 10)
        c.drawString(3.8*cm, y_pos - 0.4*cm, desc)
        
        y_pos -= 1.2*cm
    
    y_pos -= 0.5*cm
    
    # Features
    c.setFillColor(COLORS['purple_bg'])
    c.roundRect(2*cm, y_pos - 3*cm, width - 4*cm, 3*cm, 10, fill=True, stroke=False)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2.5*cm, y_pos - 0.8*cm, "üíú Ïôú HeraÎ•º ÏÑ†ÌÉùÌï¥Ïïº ÌïòÎÇòÏöî?")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 10)
    features = [
        "‚úì 6Í∞ú Ïñ∏Ïñ¥ ÏßÄÏõê (ÏòÅÏñ¥, ÌîÑÎûëÏä§Ïñ¥, ÌïúÍµ≠Ïñ¥, Ï§ëÍµ≠Ïñ¥, ÏùºÎ≥∏Ïñ¥, Ïä§ÌéòÏù∏Ïñ¥)",
        "‚úì Í≥†ÌíàÏßà AI ÏÉùÏÑ± ÏùºÎü¨Ïä§Ìä∏",
        "‚úì Ï¶âÏãú PDF Îã§Ïö¥Î°úÎìú + ÏÑ†ÌÉùÏ†Å Ïù∏ÏáÑÎ≥∏",
        "‚úì Î™®Îì† Ïó∞Î†πÍ≥º ÎÇúÏù¥ÎèÑÏóê Ï†ÅÌï©",
        "‚úì Ï†ÄÎ†¥Ìïú Í∞ÄÍ≤©: $9.99Î∂ÄÌÑ∞"
    ]
    for i, feat in enumerate(features):
        c.drawString(2.8*cm, y_pos - 1.6*cm - i*0.5*cm, feat)
    
    y_pos -= 4*cm
    
    # ===== TEST INSTRUCTIONS =====
    c.setFillColor(colors.HexColor('#fef3c7'))
    c.setStrokeColor(colors.HexColor('#f59e0b'))
    c.setLineWidth(2)
    c.roundRect(1.5*cm, y_pos - 4*cm, width - 3*cm, 4*cm, 10, fill=True, stroke=True)
    
    c.setFillColor(colors.HexColor('#b45309'))
    c.setFont("Helvetica-Bold", 16)
    c.drawString(2*cm, y_pos - 1*cm, "üß™ Î¨¥Î£åÎ°ú ÌÖåÏä§Ìä∏ÌïòÏÑ∏Ïöî!")
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica", 11)
    c.drawString(2*cm, y_pos - 1.8*cm, "Í≤∞Ï†ú Ïãú Îã§Ïùå ÌÖåÏä§Ìä∏ Ïπ¥Îìú Ï†ïÎ≥¥Î•º ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî:")
    
    c.setFont("Helvetica-Bold", 12)
    c.setFillColor(colors.HexColor('#b45309'))
    c.drawString(2.5*cm, y_pos - 2.5*cm, "üí≥ Ïπ¥Îìú Î≤àÌò∏:  4242 4242 4242 4242")
    c.drawString(2.5*cm, y_pos - 3.1*cm, "üìÖ ÎßåÎ£åÏùº:  12/25")
    c.drawString(2.5*cm, y_pos - 3.7*cm, "üîí CVV:  123")
    
    c.setFont("Helvetica-Oblique", 9)
    c.setFillColor(COLORS['text_gray'])
    c.drawString(2*cm, y_pos - 4.3*cm, "Í∑∏Îü∞ Îã§Ïùå Ïã§Ï†ú Ïù¥Î©îÏùº Ï£ºÏÜåÏôÄ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏó¨ ÌÖåÏä§Ìä∏ PDFÎ•º Î∞õÏúºÏÑ∏Ïöî!")
    
    # ===== FOOTER WITH QR CODES =====
    footer_y = 5*cm
    
    c.setStrokeColor(COLORS['purple_main'])
    c.setLineWidth(2)
    c.line(2*cm, footer_y, width - 2*cm, footer_y)
    
    c.setFillColor(COLORS['purple_dark'])
    c.setFont("Helvetica-Bold", 14)
    c.drawCentredString(width/2, footer_y - 1*cm, "üì± Ïä§Ï∫îÌïòÏó¨ Ïó∞Í≤∞ÌïòÍ∏∞")
    
    # QR Codes
    try:
        qr_website = ImageReader('images/link_website.jpg')
        c.drawImage(qr_website, 4*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(4*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(5.5*cm, footer_y - 5.2*cm, "üåê ÏõπÏÇ¨Ïù¥Ìä∏")
    
    try:
        qr_insta = ImageReader('images/insta_link.jpeg')
        c.drawImage(qr_insta, width - 7*cm, footer_y - 4.5*cm, width=3*cm, height=3*cm, preserveAspectRatio=True)
    except:
        c.setStrokeColor(COLORS['purple_main'])
        c.rect(width - 7*cm, footer_y - 4.5*cm, 3*cm, 3*cm)
    
    c.setFillColor(COLORS['text_dark'])
    c.setFont("Helvetica-Bold", 11)
    c.drawCentredString(width - 5.5*cm, footer_y - 5.2*cm, "üì∏ Ïù∏Ïä§ÌÉÄÍ∑∏Îû®")
    
    # Contact
    c.setFillColor(COLORS['text_gray'])
    c.setFont("Helvetica", 9)
    c.drawCentredString(width/2, 1.2*cm, "üìß hera.work.noreply@gmail.com")
    c.setFont("Helvetica-Bold", 9)
    c.setFillColor(COLORS['purple_main'])
    c.drawCentredString(width/2, 0.6*cm, "Made with üíú by Hera Team")
    
    c.save()
    print(f"‚úÖ Korean prospectus created: {filename}")

if __name__ == "__main__":
    print("üé® Creating beautiful Hera prospectuses...\n")
    create_prospectus_english()
    create_prospectus_korean()
    print("\n‚ú® All prospectuses created successfully!")
    print(f"üìç Location: {os.path.abspath('.')}")
